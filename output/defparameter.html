<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" href="/styles.css">
<link rel="stylesheet" href="/highlight-lisp/themes/github.css">
<script defer src="/scripts.js"></script>
<title>defparameter (CLCS)</title>

<link href="index.html#Top" rel="start" title="Top">
<link href="Data-and-Control-Flow-Dictionary.html#Data-and-Control-Flow-Dictionary" rel="up" title="Data and Control Flow Dictionary">
<link href="destructuring_002dbind.html#destructuring_002dbind" rel="next" title="destructuring-bind">
<link href="defconstant.html#defconstant" rel="prev" title="defconstant">


</head>

<body lang="en">

                        <div class="top">
                            <div class="search">
                                <svg height="20" width="20" viewBox="0 0 512 512"><path d="M221.09 64a157.09 157.09 0 10157.09 157.09A157.1 157.1 0 00221.09 64z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M338.29 338.29L448 448"/></svg>
                                <input type="text" oninput="search(event)" onkeydown="searchKeydown(event)" placeholder="Search for pages">
                                <div id="search__drop" onblur="hideSearch()"></div>
                            </div>
                            <a class="index-btn" href="index.html">
                                <svg height="20" width="20" viewBox="0 0 512 512"><title>Index</title><path d="M80 212v236a16 16 0 0016 16h96V328a24 24 0 0124-24h80a24 24 0 0124 24v136h96a16 16 0 0016-16V212" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/><path d="M480 256L266.89 52c-5-5.28-16.69-5.34-21.78 0L32 256M400 179V64h-48v69" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/></svg>
                            </a>
                        </div>
                        <div class="nav">
                            <a href="defconstant.html" class="nav-btn nav__prev ">
                                <svg height="14" width="14" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M328 112L184 256l144 144"/></svg>
                                defconstant
                            </a>
                            <a href="Data-and-Control-Flow-Dictionary.html" class="nav-btn nav__up ">
                                <svg height="14" width="14" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M112 328l144-144 144 144"/></svg>
                                Data and Control Flow Dictionary
                            </a>
                            <a href="destructuring_002dbind.html" class="nav-btn nav__next ">
                                destructuring-bind
                                <svg height="14" width="14" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="48" d="M184 112l144 144-144 144"/></svg>
                            </a>
                        </div>
                    
<a name="defparameter"></a>
<a name="defparameter_002c-defvar-_005bMacro_005d"></a>
<div class="section top-most">
<div class="node-type">Macro</div>
<h4 class="subsection">defparameter, defvar                                                </h4>

<p><code>defparameter</code>  <i>name         initial-value <span class="roman">[</span>documentation<span class="roman">]</span> </i> &rArr;  <i>name</i>
</p>
<p><code>defvar</code>  <i>name <tt>[</tt>initial-value <span class="roman">[</span>documentation<span class="roman">]</span><tt>]</tt></i> &rArr;  <i>name</i>
</p>
<a name="Arguments-and-Values_003a_003a-37"></a>
</div>
<div class="section">
<h4 class="subsubheading">Arguments and Values</h4>

<p><i>name</i>&mdash;a <i>symbol</i>; not evaluated.
</p>
<p><i>initial-value</i>&mdash;a <i>form</i>; 
     for <b>defparameter</b>, it is always <i>evaluated</i>,
 but for <b>defvar</b> it is <i>evaluated</i> 
     only if <i>name</i> is not already <i>bound</i>.
</p>
<p><i>documentation</i>&mdash;a <i>string</i>; not evaluated.
</p>
<a name="Description_003a_003a-69"></a>
</div>
<div class="section">
<h4 class="subsubheading">Description</h4>

<p><b>defparameter</b> and <b>defvar</b> <i>establish</i> <i>name</i> 
as a <i>dynamic variable</i>.
</p>
<p><b>defparameter</b> unconditionally
<i>assigns</i> the <i>initial-value</i> to the <i>dynamic variable</i> named <i>name</i>.
<b>defvar</b>, by contrast, <i>assigns</i> <i>initial-value</i> (if supplied) 
to the <i>dynamic variable</i> named <i>name</i> 
only if <i>name</i> is not already <i>bound</i>.
</p>
<p>If no <i>initial-value</i> is supplied,
<b>defvar</b> leaves the <i>value cell</i> of 
the <i>dynamic variable</i> named <i>name</i> undisturbed;
    if <i>name</i> was previously <i>bound</i>, its old <i>value</i> persists,
and if it was previously <i>unbound</i>, it remains <i>unbound</i>.
</p>
<p>If <i>documentation</i> is supplied, it is attached to <i>name</i> as a
<i>documentation string</i> of kind <b>variable</b>. 
</p>
<p><b>defparameter</b> and <b>defvar</b> normally appear as a <i>top level form</i>, 
but it is meaningful for them to appear as <i>non-top-level forms</i>.  However,
the compile-time side effects described below only take place when
they appear as <i>top level forms</i>.
</p>
<a name="Examples_003a_003a-43"></a>
</div>
<div class="section">
<h4 class="subsubheading">Examples</h4>

<div class="example">
<pre class="example"><code> (defparameter *p* 1) &rArr;  *P*
 *p* &rArr;  1
 (constantp '*p*) &rArr;  <i>false</i>
 (setq *p* 2) &rArr;  2
 (defparameter *p* 3) &rArr;  *P*
 *p* &rArr;  3

 (defvar *v* 1) &rArr;  *V*
 *v* &rArr;  1
 (constantp '*v*) &rArr;  <i>false</i>
 (setq *v* 2) &rArr;  2
 (defvar *v* 3) &rArr;  *V*
 *v* &rArr;  2

 (defun foo ()
   (let ((*p* 'p) (*v* 'v))
     (bar))) &rArr;  FOO
 (defun bar () (list *p* *v*)) &rArr;  BAR
 (foo) &rArr;  (P V)
</code>
</pre></div>

<p>The principal operational distinction between <b>defparameter</b> and <b>defvar</b>
is that <b>defparameter</b> makes an unconditional assignment to <i>name</i>,
while <b>defvar</b> makes a conditional one.  In practice, this means that
<b>defparameter</b> is useful in situations where loading or reloading the definition
would want to pick up a new value of the variable, while <b>defvar</b> is used in
situations where the old value would want to be retained if the file were loaded or reloaded.
For example, one might create a file which contained:
</p>
<div class="example">
<pre class="example"><code> (defvar *the-interesting-numbers* '())
 (defmacro define-interesting-number (name n)
   `(progn (defvar ,name ,n)
           (pushnew ,name *the-interesting-numbers*)
           ',name))
 (define-interesting-number *my-height* 168) ;cm
 (define-interesting-number *my-weight* 13)  ;stones
</code>
</pre></div>

<p>Here the initial value, <tt>()</tt>, for the variable <tt>*the-interesting-numbers*</tt>
is just a seed that we are never likely to want to reset to something else
once something has been grown from it.  As such, we have used <b>defvar</b> 
to avoid having the <tt>*interesting-numbers*</tt> information reset if the file is
loaded a second time.  It is true that the two calls to
<b>define-interesting-number</b> here would be reprocessed, but
if there were additional calls in another file, they would not be and that 
information would be lost.  On the other hand, consider the following code:
</p>
<div class="example">
<pre class="example"><code> (defparameter *default-beep-count* 3)
 (defun beep (&amp;optional (n *default-beep-count*))
   (dotimes (i n) (si:
</code>
</pre></div>

<p>Here we could easily imagine editing the code to change the initial value of
<tt>*default-beep-count*</tt>, and then reloading the file to pick up the new value.
In order to make value updating easy, we have used <b>defparameter</b>.
</p>
<p>On the other hand, there is potential value to using <b>defvar</b> in this
situation.  For example, suppose that someone had predefined an alternate
value for <tt>*default-beep-count*</tt>, or had loaded the file and then manually
changed the value.  In both cases, if we had used <b>defvar</b> instead of
<b>defparameter</b>, those user preferences would not be overridden by
(re)loading the file.
</p>
<p>The choice of whether to use <b>defparameter</b> or <b>defvar</b> has
visible consequences to programs, but is nevertheless often made for subjective
reasons.
</p>
<a name="Side-Effects_003a_003a"></a>
</div>
<div class="section">
<h4 class="subsubheading">Side Effects</h4>

<p>If a <b>defvar</b> or <b>defparameter</b> <i>form</i> appears as a <i>top level form</i>,
the <i>compiler</i> must recognize that the <i>name</i> has been
proclaimed <b>special</b>.  However, it must neither <i>evaluate</i> 
the <i>initial-value</i> <i>form</i> nor <i>assign</i> the 
<i>dynamic variable</i> named <i>name</i> at compile time.
</p>
<p>There may be additional (<i>implementation-defined</i>) compile-time or 
run-time side effects, as long as such effects do not interfere with the
correct operation of <i>conforming programs</i>.
</p>
<a name="Affected-By_003a_003a-4"></a>
</div>
<div class="section">
<h4 class="subsubheading">Affected By</h4>

<p><b>defvar</b> is affected by whether <i>name</i> is already <i>bound</i>.
</p>
<a name="See-Also_003a_003a-54"></a>
</div>
<div class="section">
<h4 class="subsubheading">See Also</h4>

<p><a href="declaim.html#declaim">declaim</a>
, 
<a href="defconstant.html#defconstant">defconstant</a>
,
<a href="documentation.html">documentation; (setf documentation)</a>
,
<a href="Compilation.html#Compilation">Compilation</a>
</p>
<a name="Notes_003a_003a-34"></a>
</div>
<div class="section">
<h4 class="subsubheading">Notes</h4>

<p>It is customary to name <i>dynamic variables</i> with an <i>asterisk</i>
at the beginning and end of the name.  e.g., <tt>*foo*</tt> is a good name for
a <i>dynamic variable</i>, but not for a <i>lexical variable</i>;
<tt>foo</tt> is a good name for a <i>lexical variable</i>, 
but not for a <i>dynamic variable</i>.
This naming convention is observed for all <i>defined names</i> in <span class="roman">Common Lisp</span>;
however, neither <i>conforming programs</i> nor <i>conforming implementations</i>
are obliged to adhere to this convention.
</p>
<p>The intent of the permission for additional side effects is to allow
<i>implementations</i> to do normal &ldquo;bookkeeping&rdquo; that accompanies
definitions.  For example, the <i>macro expansion</i> of a <b>defvar</b>
or <b>defparameter</b> <i>form</i> might include code that arranges to
record the name of the source file in which the definition occurs.
</p>
<p><b>defparameter</b> and <b>defvar</b> might be defined as follows:
</p>
<div class="example">
<pre class="example"><code> (defmacro defparameter (name initial-value 
                         &amp;optional (documentation nil documentation-p))
   `(progn (declaim (special ,name))
           (setf (symbol-value ',name) ,initial-value)
           ,(when documentation-p
              `(setf (documentation ',name 'variable) ',documentation))
           ',name))
 (defmacro defvar (name &amp;optional
                        (initial-value nil initial-value-p)
                        (documentation nil documentation-p))
   `(progn (declaim (special ,name))
           ,(when initial-value-p
              `(unless (boundp ',name)
                 (setf (symbol-value ',name) ,initial-value)))
           ,(when documentation-p
              `(setf (documentation ',name 'variable) ',documentation))
           ',name))
</code>
</pre></div>




</body>
<script type="text/javascript" src="/highlight-lisp/highlight-lisp.js"></script>
</html>

</div>